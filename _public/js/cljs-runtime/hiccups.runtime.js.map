{"version":3,"sources":["hiccups/runtime.cljs"],"mappings":"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","names":["hiccups.runtime/re-tag","hiccups.runtime/character-escapes","hiccups.runtime/container-tags","hiccups.runtime/as-str","x","cljs.core/Keyword","cljs.core/Symbol","cljs.core/name","hiccups.runtime/*html-mode*","hiccups.runtime/xml-mode?","cljs.core._EQ_","hiccups.runtime/in-mode","mode","f","*html-mode*-orig-val__37556","*html-mode*-temp-val__37557","hiccups.runtime/escape-html","text","clojure.string/escape","hiccups.runtime/h","hiccups.runtime/end-tag","hiccups.runtime/xml-attribute","name","value","p__37558","vec__37559","cljs.core.nth","hiccups.runtime/render-attribute","cljs.core/not","hiccups.runtime/render-attr-map","attrs","cljs.core.apply","cljs.core/str","cljs.core.sort","cljs.core.map","p__37568","vec__37570","seq__37571","cljs.core/seq","first__37572","cljs.core/first","cljs.core/next","hiccups.runtime/normalize-element","tag","content","vec__37578","_","id","class","cljs.core/re-matches","tag-attrs","clojure.string/replace","map-attrs","cljs.core/map?","cljs.core.merge","hiccups.runtime/render-element","element","vec__37581","or__4126__auto__","hiccups.runtime/render-html","cljs.core/vector?","cljs.core/seq?"],"sourcesContent":["(ns hiccups.runtime\n  (:require [clojure.string :as cstring]))\n\n(def ^{:doc \"Regular expression that parses a CSS-style id and class from a tag name.\" :private true}\n  re-tag #\"([^\\s\\.#]+)(?:#([^\\s\\.#]+))?(?:\\.([^\\s#]+))?\")\n\n(def ^{:doc \"Characters to replace when escaping HTML\" :private true}\n  character-escapes {\\& \"&amp;\", \\< \"&lt;\", \\> \"&gt;\", \\\" \"&quot;\"})\n\n(def ^{:doc \"A list of tags that need an explicit ending tag when rendered.\"}\n  container-tags\n  #{\"a\" \"b\" \"body\" \"canvas\" \"dd\" \"div\" \"dl\" \"dt\" \"em\" \"fieldset\" \"form\" \"h1\" \"h2\" \"h3\"\n    \"h4\" \"h5\" \"h6\" \"head\" \"html\" \"i\" \"iframe\" \"label\" \"li\" \"ol\" \"option\" \"pre\"\n    \"script\" \"span\" \"strong\" \"style\" \"table\" \"textarea\" \"ul\"})\n\n(defn as-str [x]\n  (if (or (keyword? x) (symbol? x))\n    (name x)\n    (str x)))\n\n(def ^:dynamic *html-mode* :xml)\n\n(defn- xml-mode? []\n  (= *html-mode* :xml))\n\n(defn in-mode [mode f]\n  (binding [*html-mode* mode]\n    (f)))\n\n(defn escape-html\n  \"Change special characters into HTML character entities.\"\n  [text]\n  (-> (as-str text)\n      (cstring/escape character-escapes)))\n\n(def h escape-html) ; alias for escape-html\n\n(defn end-tag []\n  (if (xml-mode?) \" />\" \">\"))\n\n(defn xml-attribute [name value]\n  (str \" \" (as-str name) \"=\\\"\" (escape-html value) \"\\\"\"))\n\n(defn render-attribute [[name value]]\n  (cond\n    (true? value)\n      (if (xml-mode?)\n          (xml-attribute name name)\n          (str \" \" (as-str name)))\n    (not value)\n      \"\"\n    :else\n      (xml-attribute name value)))\n\n(defn render-attr-map [attrs]\n  (apply str\n    (sort (map render-attribute attrs))))\n\n(defn normalize-element\n  \"Ensure a tag vector is of the form [tag-name attrs content].\"\n  [[tag & content]]\n  (when (not (or (keyword? tag) (symbol? tag) (string? tag)))\n    (throw (str tag \" is not a valid tag name\")))\n  (let [[_ tag id class] (re-matches re-tag (as-str tag))\n        tag-attrs        {:id id\n                          :class (if class (cstring/replace class \".\" \" \"))}\n        map-attrs        (first content)]\n    (if (map? map-attrs)\n      [tag (merge tag-attrs map-attrs) (next content)]\n      [tag tag-attrs content])))\n\n(declare render-html)\n\n(defn render-element\n  \"Render a tag vector as a HTML element.\"\n  [element]\n  (let [[tag attrs content] (normalize-element element)]\n    (if (or content (container-tags tag))\n      (str \"<\" tag (render-attr-map attrs) \">\"\n           (render-html content)\n           \"</\" tag \">\")\n      (str \"<\" tag (render-attr-map attrs) (end-tag)))))\n\n(defn render-html\n  \"Turn a Clojure data type into a string of HTML.\"\n  [x]\n  (cond\n    (vector? x) (render-element x)\n    (seq? x) (apply str (map render-html x))\n    :else (as-str x)))\n"]}